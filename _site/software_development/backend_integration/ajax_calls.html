<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Ajax Calls | saubhik</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Ajax Calls" />
<meta name="author" content="Saubhik Mukherjee" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Personal cyber-space dump." />
<meta property="og:description" content="Personal cyber-space dump." />
<link rel="canonical" href="http://localhost:4000/software_development/backend_integration/ajax_calls.html" />
<meta property="og:url" content="http://localhost:4000/software_development/backend_integration/ajax_calls.html" />
<meta property="og:site_name" content="saubhik" />
<script type="application/ld+json">
{"description":"Personal cyber-space dump.","author":{"@type":"Person","name":"Saubhik Mukherjee"},"@type":"WebPage","url":"http://localhost:4000/software_development/backend_integration/ajax_calls.html","headline":"Ajax Calls","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=7f90a6ed2a8ee84cfa7f3ceb5a300c7e86b460f3">
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="http://localhost:4000/">saubhik</a></h1>

        

        <p>Personal cyber-space dump.</p>

        <p class="view"><a href="https://github.com/saubhik/">View my GitHub profile<small>github.com/saubhik</small></a></p>
        <p class="view"><a href="/posts.html">Blog<small>/posts</small></a></p>

        

        <a href="/index.html">Home</a>
</br><a href="/papers/">Comments on deep learning papers</a>
</br><a href="/epi/">Elements Of Programming Interviews</a>
</br><a href="/software_development/">Software Development</a>
</br><a href="/utilities/">Utilities</a>
</br><a href="/data_science/">Data Science</a>
</br><a href="/notebooks/">Jupyter Notebooks</a>
</br><a href="/deep_learning/">Deep Learning</a>
</br><a href="/coursework/index.html">CS courses notes</a>
</br><a href="/this_site/">About this website</a>
</br><a href="/practice-javascript/">Practice Javascript</a>


      </header>
      <section>

      <h3 id="ajax-calls">Ajax Calls</h3>
<p>We cover backend integration in this document. How to communicate with the backend server?</p>

<p>AJAX is used to retrieve data from servers or download a file, CSS or image.</p>

<p>We will use a special method in JS called <code class="highlighter-rouge">xhr</code>, stands for xml http request. This retains the name <code class="highlighter-rouge">xml</code> since it was used before <code class="highlighter-rouge">json</code> format came.</p>

<p><code class="highlighter-rouge">Ajax</code> is a library written around <code class="highlighter-rouge">XHR</code> with an aim to provide better error checking and cross browser compatibility.</p>

<p><strong>Retrieving values from HTML</strong>
How to get values from HTML elements? How to extract the text from forms and input boxes?</p>

<p>Don’t put <code class="highlighter-rouge">submit</code> button inside a <code class="highlighter-rouge">form</code> element:</p>

<p><code class="highlighter-rouge">&lt;form&gt;</code> attribute expects the data to be sent to an endpoint, and when the <code class="highlighter-rouge">Submit</code> button inside the &lt;form&gt; attribute is clicked on, it expects an endpoint to send the data to. As we haven’t provided any endpoint, the form refreshes the page.</p>

<p>Keeping the <code class="highlighter-rouge">Submit</code> button outside <code class="highlighter-rouge">&lt;form&gt;</code> helps you by adding a validation process between the submission and the sending of the data. Instead of providing a <em>reference</em> to the Submit button and then expecting an endpoint on submission, the data can be manipulated to perform some checks if required and then be sent through an AJAX call.</p>

<p>Now after moving <code class="highlighter-rouge">Submit</code> outside <code class="highlighter-rouge">form</code> your UI might look broken, so put the <code class="highlighter-rouge">Submit</code> button and the <code class="highlighter-rouge">form</code> element inside a <code class="highlighter-rouge">div</code> with <code class="highlighter-rouge">class: "Container"</code> and then add the <code class="highlighter-rouge">form</code>’s CSS styles to the class <code class="highlighter-rouge">Container</code>. You can remove the <code class="highlighter-rouge">width</code> attribute from the <code class="highlighter-rouge">form</code>’s CSS since <code class="highlighter-rouge">form</code> will take the entire width of the <code class="highlighter-rouge">Container</code>.</p>

<p>You might have to give <em>reference</em> to the <code class="highlighter-rouge">form</code> inside the <code class="highlighter-rouge">submit</code> button when it is outside the <code class="highlighter-rouge">form</code>:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"form1"</span><span class="nt">&gt;</span>
  First name: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"fname"</span><span class="nt">&gt;&lt;br&gt;</span>
  Last name: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"lname"</span><span class="nt">&gt;&lt;br&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">form=</span><span class="s">“form1”</span>  <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<p>We need <code class="highlighter-rouge">JSON.stringify</code> to convert JSON objects to text, since HTTP communicates over text.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">jsonObject</span> <span class="o">=</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="s2">"Linus"</span><span class="p">,</span> <span class="na">job</span> <span class="p">:</span> <span class="s2">"Engineer"</span><span class="p">};</span>
<span class="kd">var</span> <span class="nx">jsonString</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">jsonObject</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jsonString</span><span class="p">);</span>

<span class="c1">// Console log output</span>
<span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Linus"</span><span class="p">,</span> <span class="s2">"job"</span> <span class="p">:</span> <span class="s2">"Engineer"</span><span class="p">}</span>
</code></pre></div></div>

<p><strong>XMLHttpRequest</strong>
<code class="highlighter-rouge">XMLHttpRequest.open(method, url, async, user, password)</code> initiates a new connection with the address provided as its parameter and also the method.</p>
<ol>
  <li><code class="highlighter-rouge">method</code> is the HTTP request method used to talk with the server.</li>
  <li><code class="highlighter-rouge">url</code> is the url address of the resource trying to access</li>
  <li><code class="highlighter-rouge">async</code> is optional, with default value true. When the script sends a request to the server, it continues with the execution and doesn’t wait for the response. Once the response is received the browser event is triggered and the script performs the associated actions.
4.<code class="highlighter-rouge">user</code> is optional, default is null. If the resource we are trying to access requires a username, input here.</li>
  <li><code class="highlighter-rouge">password</code> is optional, default is null. If the resource we are trying to access requires a password, input here.</li>
</ol>

<p><code class="highlighter-rouge">XMLHttpRequest.send(body)</code> connects to the server and forwards the request to the server. <code class="highlighter-rouge">body</code> is an optional parameter which can be in the form of a data or a file. If nothing is mentioned, its value is null. Primarily used for <code class="highlighter-rouge">PUT</code> or <code class="highlighter-rouge">POST</code>. <code class="highlighter-rouge">GET</code> request does not have a <code class="highlighter-rouge">body</code> parameter.</p>

<p><code class="highlighter-rouge">XMLHttpRequest.onreadystatechange = callback;</code> listens for change in <code class="highlighter-rouge">XMLHttpRequest.readyState</code>, and on change it calls the <code class="highlighter-rouge">callback</code> function.</p>

<p>The <code class="highlighter-rouge">XMLHttpRequest.readyState</code> table is:</p>
<ol>
  <li><code class="highlighter-rouge">UNSENT</code>, value <code class="highlighter-rouge">0</code>: request initiated, but call has not been opened yet.</li>
  <li><code class="highlighter-rouge">OPENED</code>, value <code class="highlighter-rouge">1</code>: <code class="highlighter-rouge">xhr.open()</code> has been called.</li>
  <li><code class="highlighter-rouge">HEADERS_RECEIVED</code>, value <code class="highlighter-rouge">2</code>: <code class="highlighter-rouge">xhr.send()</code> and headers have been called. Server acknowledged that it has been communicated with.</li>
  <li><code class="highlighter-rouge">LOADING</code>, value <code class="highlighter-rouge">3</code>: server is processing the request &amp; is sending back the data, which is being stored in <code class="highlighter-rouge">xhr.responseText</code>.</li>
  <li><code class="highlighter-rouge">DONE</code>, value <code class="highlighter-rouge">4</code>: data has been received and communication with server is done.</li>
</ol>

<p>We have to wait till <code class="highlighter-rouge">xhr.readyState == 4</code>. Then add another check for <code class="highlighter-rouge">xhr.state</code> which captures the HTTP response code sent by the server.</p>

<p><code class="highlighter-rouge">200</code> and <code class="highlighter-rouge">201</code> response codes indicate that the request was a success.</p>

<p><strong>HTTP request methods</strong>
An HTTP request method has a message head and a message body. The head contains the URL and headers, whereas the body contains the information to be sent. There are different HTTP request methods, but the major ones are as follows:</p>

<ol>
  <li>GET: request a particular resource from a server. Response can CSS file or a json object. This request does not have a message body; information is sent through the message header. It’s excellent for requests that are just supposed to send a small amount of information to a server and then receive some output.
The syntax of the GET request as sent by the browser is of the following form:
<code class="highlighter-rouge">Message Head: &lt;URL&gt;/endpoint.html?query1=query</code>
The XMLHttpRequest of a GET request would look like this:
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="err">‘</span><span class="nx">GET</span><span class="err">’</span><span class="p">,</span> <span class="err">‘</span><span class="o">&lt;</span><span class="nx">URL</span><span class="o">&gt;</span><span class="sr">/endpoint.html</span><span class="se">?</span><span class="sr">query1=query’</span><span class="se">)</span><span class="err">;
</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>POST: post data to a particular resource. Has a message body along with message head.
The information you send through a POST request is not stored in the browser; neither is the POST request cached. This makes it more desirable for sending sensitive information such as passwords or card information. The information is still sent after a proper encryption process.</li>
</ol>

<p>The syntax of a POST request as sent by the browser is —</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Message Head: &lt;url&gt;/api/test
Message Body: query1=query
</code></pre></div></div>
<p>The XMLHttpRequest of a POST request would look like this:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="err">‘</span><span class="nx">POST</span><span class="err">’</span><span class="p">,</span><span class="err">’</span><span class="o">&lt;</span><span class="nx">url</span><span class="o">&gt;</span><span class="sr">/api/</span><span class="nx">test</span><span class="err">’</span><span class="p">);</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="err">‘</span><span class="nx">query1</span><span class="o">=</span><span class="nx">query</span><span class="err">’</span><span class="p">)</span><span class="err">’</span><span class="p">;</span>
</code></pre></div></div>

<ol>
  <li>PUT: They are idempotent (making multiple identical requests has the same effect as making a single request). PUT calls instruct the server to delete the existing resource and put the resource sent in the PUT request there, instead of modifying the resource in the URL mentioned. This is important in cases where you don’t want overlap of data. PUT calls are similar to the Update operation in a database. The syntax of a PUT request as sent by the browser is —
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Message Head: &lt;url&gt;/api/test
Message Body: query1=query
</code></pre></div>    </div>
    <p>The XMLHttpRequest of a PUT request would look like this:</p>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="err">‘</span><span class="nx">PUT</span><span class="err">’</span><span class="p">,</span><span class="err">’</span><span class="o">&lt;</span><span class="nx">url</span><span class="o">&gt;</span><span class="sr">/api/</span><span class="nx">test</span><span class="err">’</span><span class="p">);</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="err">‘</span><span class="nx">query1</span><span class="o">=</span><span class="nx">query</span><span class="err">’</span><span class="p">)</span><span class="err">’</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
  <li>DELETE: delete the particular resource. Does not contain any message body.
The syntax of a DELETE request as sent by the browser is of the following form:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Message Head: &lt;URL&gt;/endpoint.html
</code></pre></div>    </div>
    <p>The XMLHttpRequest of a DELETE request would look like this:</p>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="err">‘</span><span class="nx">DELETE</span><span class="err">’</span><span class="p">,</span> <span class="err">‘</span><span class="o">&lt;</span><span class="nx">URL</span><span class="o">&gt;</span><span class="sr">/endpoint.html’</span><span class="se">)</span><span class="err">;
</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>An example script is:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">enterTheCode</span><span class="p">(</span><span class="nx">country</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"https://api.openaq.org/v1/cities?country="</span> <span class="o">+</span> <span class="nx">country</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// we could also use xhr.response</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>HTTP status codes</strong>
First digit signifies one of the 5 predefined standard classes of response:</p>
<ol>
  <li>Informational - 1: server has received the request and is processing it</li>
  <li>Success - 2: server has successfully processed the request</li>
  <li>Redirection - 3: server has redirected the request</li>
  <li>Client Error - 4: request made by the client has some error in it</li>
  <li>Server Error - 5: error in server and can’t process request</li>
</ol>

<p>Some Common HTTP response headers are as follows:</p>

<p>100 - Continue
200 - OK
201 - Created
301 - Moved Permanently
400 - Bad Request
404 - Not Found
415 - Media Type Not Supported
500 - Internal Server Error
502 - Bad Gateway</p>

<p>Error 415 is code for “Media Type Not Supported”. When you transfer some data over any application, the data needs to be sent in a fixed format so that the receiver knows how to read and interpret the data. It’s like sending data to someone in a box so the data does not get changed, but then you also need to send the key of the box to open it and access the data. The definition of the encoding is the key so that the box can be opened.</p>

<p><strong>HTTP</strong> headers are used by clients and servers to communicate with each other:</p>
<ol>
  <li><code class="highlighter-rouge">General Headers</code>: used by clients &amp; servers communicate information having no connection with the resource they have to transmit, eg “Date”, “Cache-Control”, “Connection” etc.</li>
  <li><code class="highlighter-rouge">Request Headers</code>: sent by client (browser) to the server, info about the client (browser, OS, data encoding type), or more info about the resource.
Some common request headers are as follows:
<code class="highlighter-rouge">host</code>: It tells who the host is that the request is being sent to.
<code class="highlighter-rouge">method</code>: It tells the server which HTTP request method is being used to send the request.
<code class="highlighter-rouge">accept</code>: It tells what methods are accepted by the browser.</li>
  <li><code class="highlighter-rouge">Response Headers</code>: sent by the server to the client, contain more info about the content being served to the client or the about the server.
Some common response headers are as follows:
<code class="highlighter-rouge">content-encoding</code>: This information is sent by the server telling the browser the encoding type of the content, so the browser knows how to decode it.
<code class="highlighter-rouge">expires</code>: This information is sent by the server telling the browser till when the server will sustain this particular API call.</li>
</ol>

<p>This code is an example of sending a <code class="highlighter-rouge">POST</code> request:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sendPostRequest</span><span class="p">(</span><span class="nx">userName</span><span class="p">,</span> <span class="nx">userJob</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="nx">userName</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
        <span class="na">Job</span><span class="p">:</span> <span class="nx">userJob</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span> <span class="s2">"https://reqres.in/api/users"</span><span class="p">);</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/json; charset=utf-8"</span><span class="p">);</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">params</span><span class="p">));</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">201</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
      <span class="p">}</span>  
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">window.btoa</code> encryption encodes a string in base64. Use <code class="highlighter-rouge">window.atob</code> to decode it back.</p>

<p><code class="highlighter-rouge">XMLHttpRequest.setHeader("Authorization",“Basic” + window.btoa(“Rahul:Rahul123”))</code> is used for basic authorisation. We use the <code class="highlighter-rouge">access-token</code> from the response headers after a successful login for validating all other API calls.</p>

<p>An access token is a way to tell the server that the API call that has been made to the server is by a user who’s already logged in. This is performed by the server creating a string that is unique to the user and sending the user that string after he/she logs in. This string is the access token, and for every API call after the login, this string is mandatory for the server so that it can validate the API call.</p>

<p>Access tokens are generated by the server using a secure algorithm, and then that token is stored against your credentials in a secure database by the server. Then, the token is transferred to you and that becomes your “pass” to use the APIs provided to you.</p>

<p>There is no standard practice of generating them. Each company generates them in their own random way, and the details of how they’re generated are very closely guarded.
Some companies use the user ID and subsequent information (e.g. the time stamp) to generate an access token after encoding them, whereas some others use totally random strings.</p>

<p>These methods have their own pros and cons. A totally random string as an access token is much more secure than an access token generated by encoding the user information because there is no inherent order in generating the string; hence, no data can be inferred from it.</p>

<p>On the other hand, retrieving data for a totally random string takes much more time than a string that has been generated by encoding a data sent by the user. This is because the database now has to traverse through all of the data to see if the string matches for a user.</p>

<p>Code to generate a token:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">generateToken</span><span class="p">(</span><span class="nx">userName</span><span class="p">,</span><span class="nx">userPassword</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">userName</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">userPassword</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">"Please Fill in the Complete Information"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">else</span><span class="p">{</span>
        <span class="kd">var</span> <span class="nx">currDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toLocaleTimeString</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">stringToEncode</span> <span class="o">=</span> <span class="nx">userName</span><span class="p">.</span><span class="nx">value</span><span class="o">+</span><span class="nx">userPassword</span><span class="p">.</span><span class="nx">value</span><span class="o">+</span><span class="nx">currDate</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">accessToken</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">stringToEncode</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">accessToken</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Storage Type</strong></p>
<ol>
  <li>
    <p>Cookie
Memory: 4Kb
Persistence (Lifetime of data):	Unlimited unless explicitly deleted
Access: Can be accessed both by the server as well as the client, <em>can be programmed for only server access</em>
Preferred Usage: For storing sensitive data as they can be programmed to be only used by the server</p>
  </li>
  <li>
    <p>Session Storage
Memory: At least 5Mb
Persistence (Lifetime of data): Stores the value till the tab or window remains open
Access: Can be accessed only by the client-side
Preferred Usage: For values that only need to persist for the duration of a tab eg: Score in a game</p>
  </li>
  <li>
    <p>Local Storage
Memory: At least 5Mb
Persistence (Lifetime of data): Unlimited unless explicitly deleted
Access: Can be accessed only by the client-side
Preferred Usage: For values that require ongoing persistence eg: CSS files for web pages</p>
  </li>
</ol>

<p><strong>Session Storage</strong>
Eg. items in Amazon cart, or the access token provided by the server. Local storage should not be used for such use cases because it need not stay in the memory for more than the time they are relevant (for eg. only till you do the payment in online shopping)  as storing such data would fill up the local storage very quickly.</p>

<p>We use <code class="highlighter-rouge">sessionStorage.setItem("user-detail", xhr.responseText)</code> and <code class="highlighter-rouge">sessionStorage.getItem("access-token", xhr.getResponseHeader("access-Token"))</code> in the callback <code class="highlighter-rouge">xhr.onreadystatechange</code> for storing these info in the session storage.</p>

<p><strong>window in JavaScript</strong>
The browser provides JavaScript with some APIs so that JavaScript can interact with the browser, instructing it to perform some functions like opening a new tab, or changing the current URL. These APIs are known as <strong>WebAPIs</strong>. ‘window’ is one such WebAPI, which provides the browser access to the window (your system’s window) which contains the current DOM element. In short, it represents an open window in a browser.</p>

<p>window is a global variable WebAPI, and for a given page, every Javascript function associated with the page can access its properties. Similarly, any function or variable defined globally is said to be the part/property of window variable.</p>

<p>An example of this can be found in this code snippet.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">carCompany</span> <span class="o">=</span> <span class="s2">"maserati"</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">carCompany</span><span class="p">);</span>
<span class="c1">// this gets printed in console</span>
<span class="nx">maserati</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">carCompany</code> is defined at a global level and hence is available as a variable in window.</p>

<p>Some common methods and properties provided by window variable are-
<code class="highlighter-rouge">window.innerHeight</code> - This property provides the inner height of the browser windows.
<code class="highlighter-rouge">window.open()</code> - This method opens a new window with the given URL.
<code class="highlighter-rouge">window.scrollTo()</code> - This method scrolls to a particular set of coordinates.
<code class="highlighter-rouge">window.location</code> - This property provides the current location/URL of window.</p>

<p><code class="highlighter-rouge">window.location.href</code> is a common property used to redirect webpage to a new location in the same window or tab.</p>

<p><code class="highlighter-rouge">window.location</code> method gives you the current URL, and as the link is a relative link, <code class="highlighter-rouge">window.location.href = www.google.com</code> appends the page address with <code class="highlighter-rouge">www.google.com</code>.</p>

<p>If you want to redirect the page to <code class="highlighter-rouge">www.google.com</code> using <code class="highlighter-rouge">window.location.href</code> method, you’ll have to give the complete address of the webpage i.e <code class="highlighter-rouge">https://www.google.com</code> instead of <code class="highlighter-rouge">www.google.com</code>. This is because <code class="highlighter-rouge">www.google.com</code> is a relative link, and <code class="highlighter-rouge">window.location.href</code> will append relative links at the end of the current page address.</p>

<p>Use <code class="highlighter-rouge">JSON.parse()</code> to parse string to JSON.</p>

<p>Code to get access token from the session storage: <code class="highlighter-rouge">var access = sessionStorage.getItem('access-token');</code>.</p>

<p>The session storage is being created by the window object, and as that is the global level variable, the session storage would be available to any webpage open through window variable in the context of current webpage. So it can be accessible from other tabs.</p>

<p><strong>forEach and map</strong>
<code class="highlighter-rouge">.forEach()</code> works on the array, i.e it will affect the elements of the array you asked the function to work on. <code class="highlighter-rouge">.map()</code>, on the other hand, creates a new array as the result.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">3</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">mapArr</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">index</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">mapArr</span><span class="p">);</span>
</code></pre></div></div>
<p>The output of this function would be <code class="highlighter-rouge">[2,4,6]</code>. The actual <code class="highlighter-rouge">arr</code> would not change.
<code class="highlighter-rouge">.forEach</code> function, on the other hand, does not create any new array, nor does it return any value. <code class="highlighter-rouge">.forEach</code> is best used when you need to cycle through an array and perform functions like printing the value.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">3</span><span class="p">];</span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">){</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">index</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>
<p>The output would be</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2
4
6
</code></pre></div></div>
<p>But no new value or array would be returned.</p>

<p><code class="highlighter-rouge">readyState</code> would be 4 no matter there is error code or not.</p>

<p>Making all the API calls in a for loop is a bit problematic because of security reasons. The browser thinks of multiple API calls arising from the same source as an application trying to slow down its performance by inundating it with a lot of calls, which is quite similar to spamming a system. This is the reason that browser will block any such call.</p>

<p><code class="highlighter-rouge">Event Driven API calls</code> form the backbone of modern JavaScript. Getting all the data for a particular webpage in a single API call causes the webpage to load slowly.
Imagine if Facebook loads all the data that’ll appear on your home screen in a single go. This means all the posts and all the comments on the post would be downloaded regardless of whether you want to read them or not.</p>

<p><code class="highlighter-rouge">.toString()</code> method converts to string in JS.</p>

<p><code class="highlighter-rouge">Event bubbling</code> arises when there are nested elements. The idea is that if one element is nested inside another like it was in our example, where <code class="highlighter-rouge">delete-btn</code> and <code class="highlighter-rouge">project-btn</code> are nested inside <code class="highlighter-rouge">div</code>, their events get linked.</p>

<p>Both the buttons, as well as div, have some <code class="highlighter-rouge">onClick</code> property attached to them. This causes a problem when the inner event is triggered, i.e the <code class="highlighter-rouge">onClick</code> button of the nested button (<code class="highlighter-rouge">delete-btn</code>) is clicked. This causes the <code class="highlighter-rouge">onClick</code> property of the <code class="highlighter-rouge">div</code> to be activated too. This happens because as the <code class="highlighter-rouge">div</code> is the parent container of the button, and in DOM, if you click the button, you’re clicking the div too. This bubbling of events, for eg. the <code class="highlighter-rouge">onClick</code> of child triggering the <code class="highlighter-rouge">onClick</code> of the parent is called as <code class="highlighter-rouge">event bubbling</code>. The solution to this bubbling is if there was a function that could limit the bubbling at the moment this function is defined.
There exist such a function known as <code class="highlighter-rouge">event.stopPropagation</code>. This function causes the triggering to stop the moment where this is defined. We define it in the <code class="highlighter-rouge">onClick</code> function for <code class="highlighter-rouge">delete-btn</code> to stop event bubbling.</p>

<p>Code for implementing <code class="highlighter-rouge">POST</code> request and saving the server response in <code class="highlighter-rouge">Session Storage</code>:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sendPostRequest</span><span class="p">(</span><span class="nx">userName</span><span class="p">,</span><span class="nx">userJob</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="nx">userName</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
        <span class="na">job</span><span class="p">:</span> <span class="nx">userJob</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"POST"</span><span class="p">,</span> <span class="s2">"https://reqres.in/api/users"</span><span class="p">);</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s2">"Content-Type"</span><span class="p">,</span> <span class="s2">"application/json; charset=utf-8"</span><span class="p">);</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">params</span><span class="p">));</span>
    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">"user_ID"</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This displays the response:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="s2">"https://api.openaq.org/v1/countries"</span><span class="p">);</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"country_data"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">"&lt;p&gt;Country Country Code&lt;/p&gt;"</span><span class="p">;</span>
        <span class="nx">response</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"country_data"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="s2">"&lt;p&gt;"</span> <span class="o">+</span> <span class="nx">value</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="nx">value</span><span class="p">.</span><span class="nx">code</span> <span class="o">+</span> <span class="s2">"&lt;/p&gt;"</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>



      </section>
      <footer>
        <p><small>Love &mdash; Peace &mdash; Code</small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
    
  </body>
</html>